<!DOCTYPE html>
<html lang="id">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Jasa Desain & Editing - WriteHuman</title>

  <link rel="shortcut icon" href="./assets/images/logo/favicon.ico" type="image/x-icon">
  <link rel="stylesheet" href="./assets/css/style.css">
  <link rel="stylesheet" href="./assets/css/product-detail.css">

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800;900&display=swap"
    rel="stylesheet">
</head>

<body>

  <div data-include="components/header.html"></div>

  <main>
    <div class="product-detail-page">
      <div class="container">
        
        <a href="services.html" class="btn-back-service">
            <ion-icon name="arrow-back-outline"></ion-icon> Kembali ke Layanan
        </a>

        <!-- Service Header -->
        <div class="service-header text-center mb-5">
            <h1 class="service-title">Jasa Desain & Editing Video</h1>
            <p class="service-subtitle">Poster, PPT, Feed Sosmed, hingga Video Editing Profesional</p>
            <div class="badges-container">
                <span class="badge-item"><ion-icon name="color-palette-outline"></ion-icon> Desain Kreatif</span>
                <span class="badge-item"><ion-icon name="sync-outline"></ion-icon> Revisi Gratis</span>
                <span class="badge-item"><ion-icon name="flash-outline"></ion-icon> Pengerjaan Cepat</span>
            </div>
        </div>

        <div class="product-detail-container layout-grid">
            
            <!-- Left Column: Info & Steps -->
            <div class="left-column">
                
                <div class="info-card">
                    <h3>Tentang Layanan</h3>
                    <p>Solusi visual all-in-one untuk kebutuhan akademik, bisnis, dan konten kreator. Kami menyediakan jasa desain grafis (Poster, Feed, PPT) dan editing video dengan konsep modern dan menarik. Tim kami terdiri dari desainer berpengalaman yang siap mewujudkan ide visual Anda.</p>
                    <ul class="feature-list">
                        <li><ion-icon name="checkmark-circle"></ion-icon> <strong>Custom Design:</strong> Sesuai brief dan referensi Anda.</li>
                        <li><ion-icon name="checkmark-circle"></ion-icon> <strong>High Resolution:</strong> File siap cetak dan tayang.</li>
                        <li><ion-icon name="checkmark-circle"></ion-icon> <strong>File Master:</strong> Dapatkan file mentahan (add-on).</li>
                    </ul>
                </div>

                <div class="steps-card">
                    <h3>Cara Kerja</h3>
                    <div class="step-item">
                        <div class="step-number">1</div>
                        <div class="step-content">
                            <h4>Pilih Layanan</h4>
                            <p>Tentukan jenis desain atau editing yang Anda butuhkan.</p>
                        </div>
                    </div>
                    <div class="step-item">
                        <div class="step-number">2</div>
                        <div class="step-content">
                            <h4>Kirim Brief</h4>
                            <p>Upload referensi gambar dan jelaskan konsep yang diinginkan.</p>
                        </div>
                    </div>
                    <div class="step-item">
                        <div class="step-number">3</div>
                        <div class="step-content">
                            <h4>Proses Kreatif</h4>
                            <p>Tim mengerjakan draft awal untuk Anda review.</p>
                        </div>
                    </div>
                    <div class="step-item">
                        <div class="step-number">4</div>
                        <div class="step-content">
                            <h4>Finalisasi</h4>
                            <p>Revisi (jika ada) dan download hasil final di dashboard.</p>
                        </div>
                    </div>
                </div>

                <!-- Reviews Placeholder -->
                 <div class="reviews-preview-card" style="margin-top: 30px; background: #f9f9f9; padding: 20px; border-radius: 12px;">
                    <h3 style="font-size: 1.1rem; margin-bottom: 15px;">Ulasan Terpilih</h3>
                    <div class="mini-review">
                        <div class="stars" style="color: #ffc107; display: flex; align-items: center; gap: 2px;">
                            <ion-icon name="star"></ion-icon><ion-icon name="star"></ion-icon><ion-icon name="star"></ion-icon><ion-icon name="star"></ion-icon><ion-icon name="star"></ion-icon>
                        </div>
                        <p style="font-style: italic; font-size: 0.9rem; color: #555;">"Desain PPT-nya keren banget! Sidang jadi lebih PD. Makasih kak."</p>
                        <small>- Dinda P. (Mahasiswa)</small>
                    </div>
                    <a href="service-reviews.html?service=desain" style="display: block; margin-top: 15px; text-decoration: none; color: var(--salmon-pink); font-size: 0.9rem; font-weight: 500;">
                        Lihat Semua Ulasan <ion-icon name="arrow-forward-outline"></ion-icon>
                    </a>
                 </div>

            </div>

            <!-- Right Column: Order Form -->
            <div class="right-column">
                <div class="order-card">
                    <h3>Form Order Desain</h3>
                    <form id="orderForm">
                        <!-- A. Data User -->
                        <div class="section-label">Data Pemesan</div>
                        <div class="form-group">
                            <label>Nama Lengkap</label>
                            <input type="text" id="custName" required placeholder="Nama Anda">
                        </div>
                        <div class="form-group">
                            <label>Email Aktif</label>
                            <input type="email" id="custEmail" required placeholder="email@contoh.com">
                        </div>

                        <!-- B. Jenis Layanan -->
                        <div class="section-label">Detail Pesanan</div>
                        <div class="form-group">
                            <label>Pilih Jenis Layanan</label>
                            <select id="serviceTypeSelect" required>
                                <option value="" disabled selected>-- Pilih Layanan --</option>
                                <option value="poster">Desain Poster - Rp 50.000</option>
                                <option value="ppt">Desain Slide PPT (per 10 slide) - Rp 150.000</option>
                                <option value="feed">Feed Instagram (per post) - Rp 35.000</option>
                                <option value="banner">Desain Banner/Spanduk - Rp 75.000</option>
                                <option value="video">Editing Video (Durasi < 3 menit) - Rp 200.000</option>
                                <option value="other">Lainnya (Hubungi Admin)</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label>Deskripsi / Brief Kebutuhan</label>
                            <textarea id="briefText" rows="4" placeholder="Jelaskan konsep, warna dominan, teks yang ingin ditampilkan, dll." required></textarea>
                        </div>

                        <!-- C. Upload Referensi -->
                        <div class="section-label">Upload Referensi (Opsional)</div>
                        <div class="form-group">
                            <div class="file-upload-box" id="dropZone">
                                <ion-icon name="images-outline"></ion-icon>
                                <p>Contoh desain / logo / materi</p>
                                <input type="file" id="fileInput" multiple accept="image/*,.pdf,.doc,.docx" hidden>
                                <button type="button" class="btn-select-file" onclick="document.getElementById('fileInput').click()">Pilih File</button>
                            </div>
                            <div id="fileList" class="file-list-container"></div>
                        </div>

                        <!-- D. Deadline -->
                        <div class="section-label">Pilihan Deadline</div>
                        <div class="form-group">
                            <select id="deadlineSelect" required>
                                <option value="normal" selected>Normal (2-3 Hari)</option>
                                <option value="fast">Cepat (24 Jam)</option>
                                <option value="express">Express (< 12 Jam)</option>
                            </select>
                        </div>

                        <!-- Price Info -->
                        <div class="price-estimation-box">
                            <label>Estimasi Harga</label>
                            <div class="price-value" id="priceDisplay">Rp 0</div>
                            <small class="disclaimer-text">Harga final akan dikonfirmasi admin setelah mereview tingkat kesulitan brief.</small>
                        </div>

                        <button type="submit" class="btn-submit-order">
                            Kirim Pesanan <ion-icon name="arrow-forward-outline"></ion-icon>
                        </button>
                    </form>
                </div>
            </div>

        </div>

        <!-- Syarat & Ketentuan -->
        <div class="terms-section">
            <h3><ion-icon name="warning-outline"></ion-icon> Syarat & Ketentuan</h3>
            <ul class="terms-list">
                <li><ion-icon name="checkmark-circle-outline"></ion-icon> Pembayaran DP minimal 50% di awal pengerjaan (untuk paket tertentu).</li>
                <li><ion-icon name="checkmark-circle-outline"></ion-icon> Revisi tidak termasuk perubahan total judul atau topik pembahasan.</li>
                <li><ion-icon name="checkmark-circle-outline"></ion-icon> File hasil pengerjaan akan dikirim secara bertahap sesuai progress.</li>
                <li><ion-icon name="checkmark-circle-outline"></ion-icon> Pelunasan wajib dilakukan sebelum file final (bab akhir/full) dikirimkan.</li>
                <li><ion-icon name="checkmark-circle-outline"></ion-icon> Kami menjamin kerahasiaan data dan identitas klien.</li>
            </ul>
        </div>

      </div>
    </div>
  </main>

  <div data-include="components/footer.html"></div>

  <script src="./assets/js/html-loader.js"></script>
  <script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
  <script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>

  <!-- Supabase Import Map -->
  <script type="importmap">
    {
      "imports": {
        "@supabase/supabase-js": "https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/+esm"
      }
    }
  </script>

  <script type="module">
    import { submitOrder } from './assets/js/order-service.js';

    document.addEventListener('DOMContentLoaded', () => {
        const fileInput = document.getElementById('fileInput');
        const fileList = document.getElementById('fileList');
        const priceDisplay = document.getElementById('priceDisplay');
        const serviceTypeSelect = document.getElementById('serviceTypeSelect');
        const deadlineSelect = document.getElementById('deadlineSelect');
        
        // Pricing Config
        const PRICES = {
            'poster': 50000,
            'ppt': 150000,
            'feed': 35000,
            'banner': 75000,
            'video': 200000,
            'other': 0
        };

        // 1. Handle File Upload
        fileInput.addEventListener('change', (e) => {
            fileList.innerHTML = '';
            const files = e.target.files;
            
            if (files.length > 0) {
                Array.from(files).forEach((file) => {
                    const item = document.createElement('div');
                    item.className = 'file-item-preview';
                    item.innerHTML = `
                        <ion-icon name="attach-outline"></ion-icon>
                        <span class="fname">${file.name}</span>
                        <span class="fsize">${(file.size/1024).toFixed(1)} KB</span>
                    `;
                    fileList.appendChild(item);
                });
            }
        });

        // 2. Pricing Logic
        function calculatePrice() {
            const service = serviceTypeSelect.value;
            const deadline = deadlineSelect.value;
            
            if (!service || service === 'other') {
                priceDisplay.textContent = 'Menunggu Konfirmasi';
                priceDisplay.style.fontSize = '1.2rem';
                return;
            } else {
                priceDisplay.style.fontSize = '1.8rem';
            }

            let basePrice = PRICES[service] || 0;
            
            // Deadline Multiplier
            let multiplier = 1;
            if(deadline === 'fast') multiplier = 1.3;
            if(deadline === 'express') multiplier = 1.6;

            const total = Math.ceil(basePrice * multiplier);
            priceDisplay.textContent = 'Rp ' + total.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
        }

        // Listeners
        serviceTypeSelect.addEventListener('change', calculatePrice);
        deadlineSelect.addEventListener('change', calculatePrice);

        // 3. Submit Order
        const orderForm = document.getElementById('orderForm');
        orderForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            if (!serviceTypeSelect.value) {
                alert("Silakan pilih jenis layanan!");
                return;
            }

            const btn = document.querySelector('.btn-submit-order');
            const originalText = btn.innerHTML;
            btn.innerHTML = '<span class="loader"></span> Memproses...';
            btn.disabled = true;

            const serviceName = serviceTypeSelect.options[serviceTypeSelect.selectedIndex].text.split('-')[0].trim();
            const brief = document.getElementById('briefText').value;
            const price = priceDisplay.textContent;
            const deadline = deadlineSelect.options[deadlineSelect.selectedIndex].text;

            // Prepare Data
            const orderData = {
                title: serviceName,
                description: `Brief: ${brief.substring(0, 50)}...`,
                service: serviceName, // e.g. "Desain Poster"
                status: 'Menunggu Konfirmasi',
                price: price,
                deadline: deadline,
                file_url: null
            };

            const success = await submitOrder(orderData);

            if (!success) {
                btn.innerHTML = originalText;
                btn.disabled = false;
            }
        });
    });
  </script>

  <style>
      /* Reusing styles from previous pages */
      .file-upload-box {
          border: 2px dashed #ddd;
          padding: 20px;
          text-align: center;
          border-radius: 10px;
          cursor: pointer;
          transition: all 0.3s;
      }
      .file-upload-box:hover {
          background: #f9f9f9;
          border-color: var(--salmon-pink);
      }
      .file-upload-box ion-icon {
          font-size: 2rem;
          color: var(--sonic-silver);
      }
      .file-item-preview {
          display: flex;
          align-items: center;
          gap: 10px;
          padding: 8px;
          background: #f1f1f1;
          margin-top: 5px;
          border-radius: 6px;
          font-size: 0.85rem;
      }
      .section-label {
          font-weight: 600;
          color: var(--davys-gray);
          margin-bottom: 10px;
          margin-top: 20px;
          font-size: 0.95rem;
          border-bottom: 1px solid #eee;
          padding-bottom: 5px;
      }
  </style>

</body>

</html>
